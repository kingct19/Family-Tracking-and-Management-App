{"version":3,"file":"useHubMembers-BlHRT3SA.js","sources":["../../src/features/tasks/hooks/useHubMembers.ts"],"sourcesContent":["/**\n * Hook to fetch hub members with their display names\n */\n\nimport { useQuery } from '@tanstack/react-query';\nimport { getHubMembers } from '@/lib/api/hub-api';\nimport { getUserProfile } from '@/features/auth/api/auth-api';\nimport { useHubStore } from '@/lib/store/hub-store';\n\nexport interface HubMember {\n    userId: string;\n    displayName: string;\n    email: string;\n    photoURL?: string;\n    role: 'admin' | 'member' | 'observer';\n    status: 'active' | 'inactive';\n}\n\nexport const useHubMembers = () => {\n    const { currentHub } = useHubStore();\n\n    return useQuery({\n        queryKey: ['hub-members', currentHub?.id],\n        queryFn: async () => {\n            if (!currentHub) throw new Error('No hub selected');\n\n            // Get memberships\n            const membershipsResponse = await getHubMembers(currentHub.id);\n            if (!membershipsResponse.success || !membershipsResponse.data) {\n                throw new Error(membershipsResponse.error || 'Failed to fetch members');\n            }\n\n            // Fetch user profiles for each member\n            const members: HubMember[] = [];\n            for (const membership of membershipsResponse.data) {\n                if (membership.status === 'active') {\n                    try {\n                        const userResponse = await getUserProfile(membership.userId);\n                        if (userResponse.success && userResponse.data) {\n                            members.push({\n                                userId: membership.userId,\n                                displayName: userResponse.data.displayName || userResponse.data.email.split('@')[0],\n                                email: userResponse.data.email,\n                                photoURL: userResponse.data.photoURL,\n                                role: membership.role,\n                                status: membership.status,\n                            });\n                        }\n                    } catch (error) {\n                        console.error(`Failed to fetch profile for user ${membership.userId}:`, error);\n                        // Add member with minimal info if profile fetch fails\n                        members.push({\n                            userId: membership.userId,\n                            displayName: `User ${membership.userId.slice(0, 8)}`,\n                            email: '',\n                            role: membership.role,\n                            status: membership.status,\n                        });\n                    }\n                }\n            }\n\n            return members;\n        },\n        enabled: !!currentHub,\n        staleTime: 2 * 60 * 1000, // 2 minutes\n    });\n};\n\n"],"names":["useHubMembers","currentHub","useHubStore","useQuery","queryKey","id","queryFn","async","Error","membershipsResponse","getHubMembers","success","data","error","members","membership","status","userResponse","getUserProfile","userId","push","displayName","email","split","photoURL","role","console","slice","enabled","staleTime"],"mappings":"+FAkBO,MAAMA,EAAgB,KACzB,MAAMC,WAAEA,GAAeC,IAEvB,OAAOC,EAAS,CACZC,SAAU,CAAC,cAAeH,GAAYI,IACtCC,QAASC,UACL,IAAKN,EAAY,MAAM,IAAIO,MAAM,mBAGjC,MAAMC,QAA4BC,EAAcT,EAAWI,IAC3D,IAAKI,EAAoBE,UAAYF,EAAoBG,KACrD,MAAM,IAAIJ,MAAMC,EAAoBI,OAAS,2BAIjD,MAAMC,EAAuB,GAC7B,IAAA,MAAWC,KAAcN,EAAoBG,KACzC,GAA0B,WAAtBG,EAAWC,OACX,IACI,MAAMC,QAAqBC,EAAeH,EAAWI,QACjDF,EAAaN,SAAWM,EAAaL,MACrCE,EAAQM,KAAK,CACTD,OAAQJ,EAAWI,OACnBE,YAAaJ,EAAaL,KAAKS,aAAeJ,EAAaL,KAAKU,MAAMC,MAAM,KAAK,GACjFD,MAAOL,EAAaL,KAAKU,MACzBE,SAAUP,EAAaL,KAAKY,SAC5BC,KAAMV,EAAWU,KACjBT,OAAQD,EAAWC,QAG/B,OAASH,GACLa,QAAQb,MAAM,oCAAoCE,EAAWI,UAAWN,GAExEC,EAAQM,KAAK,CACTD,OAAQJ,EAAWI,OACnBE,YAAa,QAAQN,EAAWI,OAAOQ,MAAM,EAAG,KAChDL,MAAO,GACPG,KAAMV,EAAWU,KACjBT,OAAQD,EAAWC,QAE3B,CAIR,OAAOF,GAEXc,UAAW3B,EACX4B,UAAW"}