import{h as e,r as t,j as r,aE as s}from"./vendor-Yz3niDpg.js";import{o as a,b as o,m as c,u as n,L as i}from"./index-XwJoYhXH.js";import"./query-C1EzXcVj.js";import"./firebase-BB8Fp3FL.js";import"./state-CPa13AEy.js";const u=({children:u})=>{const{isAuthenticated:d,isLoading:l,user:m}=n(),f=e(),[g,h]=t.useState(!1);return t.useEffect(()=>{const e=setTimeout(()=>{h(!0)},5e3);return()=>clearTimeout(e)},[]),t.useEffect(()=>{d&&m&&(async(e,t)=>{try{const r=await a(e);if(r.success&&r.data&&r.data.length>0){const e=r.data[0];return void o.getState().setCurrentHub(e,"admin")}const s=`${t||"My Family"}'s Hub`,n=await c({name:s,description:"My family hub for staying connected",featureToggles:{location:!0,tasks:!0,chat:!0,vault:!0,xp:!0,leaderboard:!0,geofencing:!0,deviceMonitoring:!0}},e);n.success&&n.data?o.getState().setCurrentHub(n.data,"admin"):console.error("Failed to create default hub:",n.error)}catch(r){console.error("Error in ensureUserHasHub:",r)}})(m.id,m.displayName||void 0).then(()=>{console.log("Hub check completed")}).catch(e=>{console.error("ProtectedRoute: Hub check error:",e)})},[d,m]),l&&!g?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:r.jsx(i,{size:"large"})}):d?r.jsx(r.Fragment,{children:u}):r.jsx(s,{to:"/login",state:{from:f},replace:!0})};export{u as default};
//# sourceMappingURL=ProtectedRoute-BEe-EDMc.js.map
