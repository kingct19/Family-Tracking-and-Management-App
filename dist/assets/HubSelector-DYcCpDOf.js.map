{"version":3,"file":"HubSelector-DYcCpDOf.js","sources":["../../src/features/hubs/components/CreateHubModal.tsx","../../src/features/hubs/components/JoinHubModal.tsx","../../src/features/location/components/HubSelector.tsx"],"sourcesContent":["import { useState } from 'react';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { FiX, FiUsers } from 'react-icons/fi';\nimport { createHub } from '@/lib/api/hub-api';\nimport { useAuth } from '@/features/auth/hooks/useAuth';\nimport { useHubStore } from '@/lib/store/hub-store';\nimport { getUserMembership } from '@/lib/api/hub-api';\nimport { getUserHubs } from '@/lib/api/hub-api';\nimport { createHubSchema, type CreateHubFormData } from '@/lib/validation/hub-schemas';\nimport { TextField } from '@/components/ui/TextField';\nimport { Button } from '@/components/ui/Button';\nimport toast from 'react-hot-toast';\n\ninterface CreateHubModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\nexport const CreateHubModal = ({ isOpen, onClose }: CreateHubModalProps) => {\n    const { user } = useAuth();\n    const { setCurrentHub } = useHubStore();\n    const queryClient = useQueryClient();\n    const [formData, setFormData] = useState<CreateHubFormData>({\n        name: '',\n        description: '',\n        featureToggles: {\n            location: true,\n            tasks: true,\n            chat: true,\n            vault: false,\n            xp: true,\n            leaderboard: true,\n            geofencing: false,\n            deviceMonitoring: true,\n        },\n    });\n    const [errors, setErrors] = useState<Partial<Record<keyof CreateHubFormData, string>>>({});\n\n    const createHubMutation = useMutation({\n        mutationFn: async (data: CreateHubFormData) => {\n            if (!user) throw new Error('User not authenticated');\n            return createHub(data, user.id);\n        },\n        onSuccess: async (response) => {\n            if (response.success && response.data && user) {\n                // Invalidate hubs query\n                queryClient.invalidateQueries({ queryKey: ['hubs', user.id] });\n\n                // Switch to the new hub\n                const membershipResponse = await getUserMembership(response.data.id, user.id);\n                if (membershipResponse.success && membershipResponse.data) {\n                    setCurrentHub(response.data, membershipResponse.data.role);\n                }\n\n                toast.success('Hub created successfully!');\n                onClose();\n                setFormData({\n                    name: '',\n                    description: '',\n                    featureToggles: {\n                        location: true,\n                        tasks: true,\n                        chat: true,\n                        vault: false,\n                        xp: true,\n                        leaderboard: true,\n                        geofencing: false,\n                        deviceMonitoring: true,\n                    },\n                });\n            } else {\n                toast.error(response.error || 'Failed to create hub');\n            }\n        },\n        onError: (error: any) => {\n            toast.error(error.message || 'Failed to create hub');\n        },\n    });\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setErrors({});\n\n        const result = createHubSchema.safeParse(formData);\n        if (!result.success) {\n            const fieldErrors: Partial<Record<keyof CreateHubFormData, string>> = {};\n            result.error.errors.forEach((err) => {\n                if (err.path[0]) {\n                    fieldErrors[err.path[0] as keyof CreateHubFormData] = err.message;\n                }\n            });\n            setErrors(fieldErrors);\n            return;\n        }\n\n        createHubMutation.mutate(formData);\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n            <div className=\"bg-white rounded-xl shadow-2xl w-full max-w-md\">\n                <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\n                    <h2 className=\"text-2xl font-bold text-gray-900\">Create Hub</h2>\n                    <button\n                        onClick={onClose}\n                        className=\"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors\"\n                        aria-label=\"Close\"\n                    >\n                        <FiX size={20} />\n                    </button>\n                </div>\n\n                <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\n                    <TextField\n                        label=\"Hub Name\"\n                        value={formData.name}\n                        onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                        error={errors.name}\n                        required\n                        fullWidth\n                        placeholder=\"e.g., My Family, School Group\"\n                    />\n\n                    <div className=\"w-full\">\n                        <label className=\"block text-label-md text-on-surface mb-2\">\n                            Description (Optional)\n                        </label>\n                        <textarea\n                            value={formData.description || ''}\n                            onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                            className=\"w-full px-4 py-3 text-body-md text-on-surface bg-surface border-2 rounded-xl border-outline focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary\"\n                            placeholder=\"Brief description of your hub\"\n                            rows={3}\n                        />\n                        {errors.description && (\n                            <p className=\"text-label-sm text-error mt-2\">{errors.description}</p>\n                        )}\n                    </div>\n\n                    <div className=\"flex gap-3 pt-4\">\n                        <Button\n                            type=\"button\"\n                            variant=\"outlined\"\n                            onClick={onClose}\n                            fullWidth\n                            disabled={createHubMutation.isPending}\n                        >\n                            Cancel\n                        </Button>\n                        <Button\n                            type=\"submit\"\n                            variant=\"filled\"\n                            fullWidth\n                            loading={createHubMutation.isPending}\n                            disabled={createHubMutation.isPending}\n                        >\n                            Create Hub\n                        </Button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    );\n};\n\n","import { useState } from 'react';\nimport { FiX, FiKey } from 'react-icons/fi';\nimport { useAuth } from '@/features/auth/hooks/useAuth';\nimport { useHubStore } from '@/lib/store/hub-store';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { joinHubWithInvite } from '@/features/auth/api/invite-api';\nimport { getUserHubs, getUserMembership } from '@/lib/api/hub-api';\nimport { TextField } from '@/components/ui/TextField';\nimport { Button } from '@/components/ui/Button';\nimport toast from 'react-hot-toast';\n\ninterface JoinHubModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\nexport const JoinHubModal = ({ isOpen, onClose }: JoinHubModalProps) => {\n    const { user, joinHub } = useAuth();\n    const { setCurrentHub } = useHubStore();\n    const queryClient = useQueryClient();\n    const [inviteCode, setInviteCode] = useState('');\n    const [error, setError] = useState('');\n\n    const joinHubMutation = useMutation({\n        mutationFn: async (code: string) => {\n            if (!user) throw new Error('User not authenticated');\n            return joinHub(code);\n        },\n        onSuccess: async (response) => {\n            if (response.success && response.data && user) {\n                // Invalidate hubs query\n                queryClient.invalidateQueries({ queryKey: ['hubs', user.id] });\n\n                // Switch to the new hub\n                const { hubId, role } = response.data;\n                const hubsResponse = await getUserHubs(user.id);\n                if (hubsResponse.success && hubsResponse.data) {\n                    const newHub = hubsResponse.data.find(h => h.id === hubId);\n                    if (newHub) {\n                        setCurrentHub(newHub, role);\n                    }\n                }\n\n                toast.success('Successfully joined hub!');\n                onClose();\n                setInviteCode('');\n                setError('');\n            } else {\n                const errorMsg = response.error || 'Failed to join hub';\n                setError(errorMsg);\n                toast.error(errorMsg);\n            }\n        },\n        onError: (error: any) => {\n            const errorMsg = error.message || 'Failed to join hub';\n            setError(errorMsg);\n            toast.error(errorMsg);\n        },\n    });\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError('');\n\n        if (!inviteCode.trim()) {\n            setError('Please enter an invite code');\n            return;\n        }\n\n        // Normalize invite code (remove spaces, convert to uppercase)\n        const normalizedCode = inviteCode.trim().replace(/\\s+/g, '').toUpperCase();\n        joinHubMutation.mutate(normalizedCode);\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n            <div className=\"bg-white rounded-xl shadow-2xl w-full max-w-md\">\n                <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\n                    <h2 className=\"text-2xl font-bold text-gray-900\">Join Hub</h2>\n                    <button\n                        onClick={onClose}\n                        className=\"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors\"\n                        aria-label=\"Close\"\n                    >\n                        <FiX size={20} />\n                    </button>\n                </div>\n\n                <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\n                    <div>\n                        <TextField\n                            label=\"Invite Code\"\n                            value={inviteCode}\n                            onChange={(e) => {\n                                setInviteCode(e.target.value);\n                                setError('');\n                            }}\n                            error={error}\n                            required\n                            fullWidth\n                            placeholder=\"XXXX-XXXX\"\n                            startAdornment={<FiKey size={20} />}\n                        />\n                        <p className=\"text-sm text-gray-500 mt-2\">\n                            Enter the invite code provided by the hub administrator\n                        </p>\n                    </div>\n\n                    <div className=\"flex gap-3 pt-4\">\n                        <Button\n                            type=\"button\"\n                            variant=\"outlined\"\n                            onClick={onClose}\n                            fullWidth\n                            disabled={joinHubMutation.isPending}\n                        >\n                            Cancel\n                        </Button>\n                        <Button\n                            type=\"submit\"\n                            variant=\"filled\"\n                            fullWidth\n                            loading={joinHubMutation.isPending}\n                            disabled={joinHubMutation.isPending || !inviteCode.trim()}\n                        >\n                            Join Hub\n                        </Button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    );\n};\n\n","/**\n * HubSelector Component\n * \n * Dropdown to switch between user's hubs\n */\n\nimport { useState, useEffect, useRef } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { FiUsers, FiChevronDown, FiCheck, FiPlus, FiKey } from 'react-icons/fi';\nimport { useHubStore } from '@/lib/store/hub-store';\nimport { useAuth } from '@/features/auth/hooks/useAuth';\nimport { getUserHubs, getUserMembership } from '@/lib/api/hub-api';\nimport { LoadingSpinner } from '@/components/LoadingSpinner';\nimport { CreateHubModal } from '@/features/hubs/components/CreateHubModal';\nimport { JoinHubModal } from '@/features/hubs/components/JoinHubModal';\nimport toast from 'react-hot-toast';\n\nexport const HubSelector = () => {\n    const { user } = useAuth();\n    const { currentHub, setCurrentHub } = useHubStore();\n    const [isOpen, setIsOpen] = useState(false);\n    const [showCreateModal, setShowCreateModal] = useState(false);\n    const [showJoinModal, setShowJoinModal] = useState(false);\n    const dropdownRef = useRef<HTMLDivElement>(null);\n\n    // Fetch user's hubs\n    const { data: hubs, isLoading } = useQuery({\n        queryKey: ['hubs', user?.id],\n        queryFn: async () => {\n            if (!user) throw new Error('User not authenticated');\n            const response = await getUserHubs(user.id);\n            if (!response.success) throw new Error(response.error);\n            return response.data || [];\n        },\n        enabled: !!user,\n    });\n\n    // Close dropdown when clicking outside\n    useEffect(() => {\n        const handleClickOutside = (event: MouseEvent) => {\n            if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n                setIsOpen(false);\n            }\n        };\n\n        if (isOpen) {\n            document.addEventListener('mousedown', handleClickOutside);\n        }\n\n        return () => {\n            document.removeEventListener('mousedown', handleClickOutside);\n        };\n    }, [isOpen]);\n\n    const handleHubSelect = async (hubId: string) => {\n        if (!user || hubId === currentHub?.id) {\n            setIsOpen(false);\n            return;\n        }\n\n        try {\n            const membershipResponse = await getUserMembership(hubId, user.id);\n            if (membershipResponse.success && membershipResponse.data) {\n                const selectedHub = hubs?.find(h => h.id === hubId);\n                if (selectedHub) {\n                    setCurrentHub(selectedHub, membershipResponse.data.role);\n                    toast.success(`Switched to ${selectedHub.name}`, {\n                        icon: 'ðŸ”„',\n                        duration: 2000,\n                    });\n                    // Invalidate queries to refresh data for new hub\n                    // This will be handled by React Query automatically when currentHub changes\n                }\n            }\n        } catch (error) {\n            console.error('Failed to switch hub:', error);\n            toast.error('Failed to switch hub');\n        }\n\n        setIsOpen(false);\n    };\n\n    if (!user) return null;\n\n    return (\n        <div className=\"relative\" ref={dropdownRef}>\n            <button\n                onClick={() => setIsOpen(!isOpen)}\n                className=\"flex items-center gap-2 px-4 py-2 bg-white rounded-full shadow-md hover:shadow-lg transition-all duration-200 hover:scale-105 active:scale-95\"\n                aria-label=\"Select hub\"\n                aria-expanded={isOpen}\n            >\n                <FiUsers size={18} className=\"text-purple-600\" />\n                <span className=\"font-semibold text-gray-900 text-sm hidden sm:inline\">\n                    {currentHub?.name || 'Select Hub'}\n                </span>\n                <span className=\"font-semibold text-gray-900 text-sm sm:hidden\">\n                    Hub\n                </span>\n                <FiChevronDown \n                    size={16} \n                    className={`text-gray-500 transition-transform ${isOpen ? 'rotate-180' : ''}`} \n                />\n            </button>\n\n            {/* Dropdown */}\n            {isOpen && (\n                <div className=\"absolute top-full left-0 mt-2 w-64 bg-white rounded-xl shadow-2xl border border-gray-200 z-50 max-h-96 overflow-hidden\">\n                    <div className=\"p-2\">\n                        {/* Action Buttons */}\n                        <div className=\"space-y-1 mb-2 pb-2 border-b border-gray-200\">\n                            <button\n                                onClick={() => {\n                                    setIsOpen(false);\n                                    setShowCreateModal(true);\n                                }}\n                                className=\"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-700 hover:bg-purple-50 transition-colors\"\n                            >\n                                <div className=\"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center\">\n                                    <FiPlus size={18} className=\"text-purple-600\" />\n                                </div>\n                                <span className=\"font-medium\">Create Hub</span>\n                            </button>\n                            <button\n                                onClick={() => {\n                                    setIsOpen(false);\n                                    setShowJoinModal(true);\n                                }}\n                                className=\"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-700 hover:bg-indigo-50 transition-colors\"\n                            >\n                                <div className=\"w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center\">\n                                    <FiKey size={18} className=\"text-indigo-600\" />\n                                </div>\n                                <span className=\"font-medium\">Join Hub</span>\n                            </button>\n                        </div>\n\n                        {/* Hub List */}\n                        {isLoading ? (\n                            <div className=\"flex items-center justify-center py-8\">\n                                <LoadingSpinner />\n                            </div>\n                        ) : hubs && hubs.length > 0 ? (\n                            <div className=\"space-y-1\">\n                                {hubs.map((hub) => (\n                                    <button\n                                        key={hub.id}\n                                        onClick={() => handleHubSelect(hub.id)}\n                                        className={`w-full flex items-center justify-between px-4 py-3 rounded-lg transition-colors ${\n                                            hub.id === currentHub?.id\n                                                ? 'bg-purple-100 text-purple-700 font-semibold'\n                                                : 'text-gray-700 hover:bg-gray-100'\n                                        }`}\n                                    >\n                                        <div className=\"flex items-center gap-3\">\n                                            <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-indigo-600 flex items-center justify-center text-white text-sm font-semibold\">\n                                                {hub.name.charAt(0).toUpperCase()}\n                                            </div>\n                                            <div className=\"text-left\">\n                                                <div className=\"font-medium\">{hub.name}</div>\n                                                {hub.description && (\n                                                    <div className=\"text-xs text-gray-500 truncate\">\n                                                        {hub.description}\n                                                    </div>\n                                                )}\n                                            </div>\n                                        </div>\n                                        {hub.id === currentHub?.id && (\n                                            <FiCheck size={18} className=\"text-purple-600\" />\n                                        )}\n                                    </button>\n                                ))}\n                            </div>\n                        ) : (\n                            <div className=\"text-center py-8 text-gray-500\">\n                                <p className=\"text-sm\">No hubs found</p>\n                                <p className=\"text-xs mt-1\">Create or join a hub to get started</p>\n                            </div>\n                        )}\n                    </div>\n                </div>\n            )}\n\n            {/* Modals */}\n            <CreateHubModal\n                isOpen={showCreateModal}\n                onClose={() => setShowCreateModal(false)}\n            />\n            <JoinHubModal\n                isOpen={showJoinModal}\n                onClose={() => setShowJoinModal(false)}\n            />\n        </div>\n    );\n};\n"],"names":["CreateHubModal","isOpen","onClose","user","useAuth","setCurrentHub","useHubStore","queryClient","useQueryClient","formData","setFormData","useState","name","description","featureToggles","location","tasks","chat","vault","xp","leaderboard","geofencing","deviceMonitoring","errors","setErrors","createHubMutation","useMutation","mutationFn","async","data","Error","createHub","id","onSuccess","response","success","invalidateQueries","queryKey","membershipResponse","getUserMembership","role","toast","error","onError","message","className","children","jsxs","jsx","onClick","FiX","size","onSubmit","e","preventDefault","result","createHubSchema","safeParse","fieldErrors","forEach","err","path","mutate","TextField","label","value","onChange","target","required","fullWidth","placeholder","rows","Button","type","variant","disabled","isPending","loading","JoinHubModal","joinHub","inviteCode","setInviteCode","setError","joinHubMutation","code","hubId","hubsResponse","getUserHubs","newHub","find","h","errorMsg","trim","normalizedCode","replace","toUpperCase","startAdornment","FiKey","HubSelector","currentHub","setIsOpen","showCreateModal","setShowCreateModal","showJoinModal","setShowJoinModal","dropdownRef","useRef","hubs","isLoading","useQuery","queryFn","enabled","useEffect","handleClickOutside","event","current","contains","document","addEventListener","removeEventListener","ref","FiUsers","FiChevronDown","FiPlus","LoadingSpinner","length","map","hub","selectedHub","icon","duration","console","handleHubSelect","charAt","FiCheck"],"mappings":"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"}