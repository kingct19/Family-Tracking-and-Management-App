import{g as r,e,f as s,z as t}from"./vendor-Yz3niDpg.js";import{b as a,u as o}from"./index-XwJoYhXH.js";import{c as i,u,d as n,a as c,g as d}from"./task-api-CifnuJS5.js";import{a as w}from"./xp-api-Dlw9aMIE.js";const h=()=>{const{currentHub:e}=a();return r({queryKey:["tasks","hub",e?.id],queryFn:async()=>{if(!e)throw new Error("No hub selected");const r=await d(e.id);if(!r.success)throw new Error(r.error);return r.data},enabled:!!e,staleTime:3e4})},y=()=>{const r=e(),{currentHub:t}=a(),{user:u}=o();return s({mutationFn:async r=>{if(!t||!u)throw new Error("No hub or user");const e=await i(t.id,r,u.id);if(!e.success)throw new Error(e.error);return e.data},onSuccess:()=>{r.invalidateQueries({queryKey:["tasks","hub",t?.id]})}})},b=()=>{const r=e(),{currentHub:t}=a();return s({mutationFn:async({taskId:r,updates:e})=>{if(!t)throw new Error("No hub selected");const s=await u(t.id,r,e);if(!s.success)throw new Error(s.error)},onSuccess:()=>{r.invalidateQueries({queryKey:["tasks","hub",t?.id]})}})},m=()=>{const r=e(),{currentHub:t}=a();return s({mutationFn:async r=>{if(!t)throw new Error("No hub selected");const e=await n(t.id,r);if(!e.success)throw new Error(e.error)},onSuccess:()=>{r.invalidateQueries({queryKey:["tasks","hub",t?.id]})}})},l=()=>{const r=e(),{currentHub:i}=a(),{user:u}=o();return s({mutationFn:async r=>{if(!i)throw new Error("No hub selected");const e=await c(i.id,r.taskId);if(!e.success)throw new Error(e.error);if(u&&r.task.assignedTo===u.id){const e=r.task.weight||10;(await w({userId:u.id,userName:u.displayName||u.email,amount:e,source:"task_completion",sourceId:r.taskId,description:`Completed task: ${r.task.title}`,hubId:i.id})).success&&t.success(`ðŸŽ‰ +${e} XP for completing the task!`,{duration:3e3})}},onSuccess:()=>{r.invalidateQueries({queryKey:["tasks","hub",i?.id]}),r.invalidateQueries({queryKey:["xpRecords"]}),r.invalidateQueries({queryKey:["leaderboard"]})}})};export{l as a,m as b,y as c,b as d,h as u};
//# sourceMappingURL=useTasks-CcRx-I0r.js.map
