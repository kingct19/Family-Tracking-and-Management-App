import{T as s,z as e,p as r,q as a,x as t,B as o,r as c}from"./firebase-BB8Fp3FL.js";import{d as u}from"./index-XwJoYhXH.js";const d=async a=>{try{const t={userId:a.userId,userName:a.userName,amount:a.amount,source:a.source,sourceId:a.sourceId||null,description:a.description,timestamp:s.now(),hubId:a.hubId||null},o=await e(r(u,"xpRecords"),t);return{success:!0,data:{id:o.id,...a,timestamp:new Date}}}catch(t){return console.error("Award XP error:",t),{success:!1,error:t instanceof Error?t.message:"Failed to award XP"}}},n=async(s,e=10)=>{try{const d=s?a(r(u,"xpRecords"),t("hubId","==",s),o("timestamp","desc")):a(r(u,"xpRecords"),o("timestamp","desc")),n=await c(d),m={};n.forEach(s=>{const e=s.data();m[e.userId]||(m[e.userId]={userName:e.userName,totalXP:0}),m[e.userId].totalXP+=e.amount});return{success:!0,data:Object.entries(m).map(([s,e])=>({userId:s,userName:e.userName,totalXP:e.totalXP,photoURL:e.photoURL,rank:0})).sort((s,e)=>e.totalXP-s.totalXP).slice(0,e).map((s,e)=>({...s,rank:e+1}))}}catch(d){return console.error("Get leaderboard error:",d),{success:!0,data:[]}}};export{d as a,n as g};
//# sourceMappingURL=xp-api-Dlw9aMIE.js.map
