import{n as e,j as s,a8 as a,a9 as l,q as t,s as r,v as i,w as o,a3 as n,a7 as c,z as d,aa as m,D as x,E as u,aq as f,h as b,r as p,a4 as h,aA as g}from"./vendor-Yz3niDpg.js";import{b as j,u as v,f as y,e as w,L as N}from"./index-XwJoYhXH.js";import{c as z}from"./state-CPa13AEy.js";import{H as k}from"./HubSelector-DYcCpDOf.js";import"./query-C1EzXcVj.js";import"./firebase-BB8Fp3FL.js";import"./hub-schemas-CrELoLa9.js";import"./TextField-wgpo0Y90.js";import"./Button-D6lpmbx7.js";const S=()=>{const{isFeatureEnabled:m}=j(),{logout:x,isLoggingOut:u}=v(),f=e(),b=[{to:"/map",icon:s.jsx(t,{size:20}),label:"Map",feature:"location"},{to:"/tasks",icon:s.jsx(r,{size:20}),label:"Tasks",feature:"tasks"},{to:"/messages",icon:s.jsx(i,{size:20}),label:"Messages",feature:"chat"},{to:"/vault",icon:s.jsx(o,{size:20}),label:"Vault",feature:"vault"},{to:"/dashboard",icon:s.jsx(n,{size:20}),label:"Dashboard"},{to:"/settings",icon:s.jsx(c,{size:20}),label:"Settings"}].filter(e=>!e.feature||m(e.feature));return s.jsxs("nav",{className:"h-full flex flex-col py-4",children:[s.jsx("div",{className:"flex-1 space-y-1 px-2",children:b.map(e=>s.jsxs(a,{to:e.to,className:({isActive:e})=>y("flex items-center gap-3 px-4 py-3 rounded-lg transition-colors duration-fast","text-body-md font-medium","focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",{"bg-secondary-container text-on-secondary-container":e,"text-on-surface hover:bg-surface-variant":!e}),children:[e.icon,s.jsx("span",{children:e.label})]},e.to))}),s.jsx("div",{className:"px-2 pt-4 border-t border-outline-variant",children:s.jsxs("button",{onClick:async()=>{try{await x(),d.success("Logged out successfully"),f("/login")}catch(e){d.error("Failed to logout")}},disabled:u,className:y("w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-colors duration-fast","text-body-md font-medium","text-error hover:bg-error-container focus:outline-none focus:ring-2 focus:ring-error focus:ring-offset-2",{"opacity-50 cursor-not-allowed":u}),children:[s.jsx(l,{size:20}),s.jsx("span",{children:u?"Logging out...":"Logout"})]})})]})},L=z(e=>({modals:[],isSidebarOpen:!1,globalLoading:!1,openModal:(s,a,l)=>e(e=>({modals:[...e.modals,{id:s,component:a,props:l}]})),closeModal:s=>e(e=>({modals:e.modals.filter(e=>e.id!==s)})),closeAllModals:()=>e({modals:[]}),toggleSidebar:()=>e(e=>({isSidebarOpen:!e.isSidebarOpen})),setSidebarOpen:s=>e({isSidebarOpen:s}),setGlobalLoading:s=>e({globalLoading:s})})),C=()=>{const a=e(),{toggleSidebar:l}=L(),{currentRole:t}=j(),{user:r}=v(),{data:i}=w(r?.id);return s.jsx("header",{className:"bg-white/95 backdrop-blur-md shadow-sm border-b border-gray-200 relative",children:s.jsxs("div",{className:"flex items-center justify-between p-4 safe-top",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:l,className:"w-10 h-10 bg-white rounded-full shadow-md hover:shadow-lg transition-all duration-200 hover:scale-105 active:scale-95 flex items-center justify-center","aria-label":"Open menu",children:s.jsx(m,{size:20,className:"text-gray-700"})}),s.jsx(k,{}),t&&s.jsxs("div",{className:"hidden sm:flex items-center gap-1.5 px-2.5 py-1.5 rounded-full text-xs font-semibold "+("admin"===t?"bg-purple-100 text-purple-700":"member"===t?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:["admin"===t&&s.jsx(x,{size:12}),"member"===t&&s.jsx(u,{size:12}),"observer"===t&&s.jsx(f,{size:12}),s.jsx("span",{className:"capitalize",children:t})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>a("/profile"),className:"w-10 h-10 bg-white rounded-full shadow-md hover:shadow-lg transition-all duration-200 hover:scale-105 active:scale-95 flex items-center justify-center overflow-hidden","aria-label":"Profile",children:i?.photoURL?s.jsx("img",{src:i.photoURL,alt:i.displayName||"Profile",className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full bg-primary flex items-center justify-center",children:s.jsx("span",{className:"text-xs font-semibold text-on-primary",children:(o=i?.displayName||r?.email||"U",o.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2))})})}),s.jsx("button",{onClick:()=>a("/settings"),className:"w-10 h-10 bg-white rounded-full shadow-md hover:shadow-lg transition-all duration-200 hover:scale-105 active:scale-95 flex items-center justify-center","aria-label":"Settings",children:s.jsx(c,{size:20,className:"text-gray-700"})})]})]})});var o},O=()=>{const{isSidebarOpen:e,setSidebarOpen:a}=L(),l=b(),t="/map"===l.pathname||"/"===l.pathname,r="/messages"===l.pathname,i=t||r;return p.useEffect(()=>{a(!1)},[l.pathname,a]),s.jsxs("div",{className:y("min-h-screen bg-background flex flex-col",i&&"relative"),children:[s.jsx("div",{className:y(i&&"absolute top-0 left-0 right-0 z-50"),children:s.jsx(C,{})}),i&&e&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[60]",onClick:()=>a(!1)}),s.jsxs("aside",{className:"fixed top-0 left-0 bottom-0 w-80 max-w-[85vw] bg-white shadow-2xl z-[70] transform transition-transform duration-300 animate-in slide-in-from-left",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Menu"}),s.jsx("button",{onClick:()=>a(!1),className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors","aria-label":"Close menu",children:s.jsx(h,{size:20})})]}),s.jsx("div",{className:"overflow-y-auto h-[calc(100%-64px)]",children:s.jsx(S,{})})]})]}),s.jsxs("div",{className:"flex flex-1 overflow-hidden relative",children:[!i&&s.jsx("aside",{className:y("hidden md:block w-64 bg-surface border-r border-outline-variant transition-transform duration-normal",e?"relative z-10":"absolute left-0 top-0 bottom-0 -translate-x-full z-0"),children:s.jsx(S,{})}),s.jsx("main",{className:y("flex-1 overflow-y-auto",i?"relative":"pb-16 md:pb-0"),children:s.jsx(p.Suspense,{fallback:s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:s.jsx(N,{size:"large",text:"Loading page..."})}),children:i?s.jsx(g,{}):s.jsx("div",{className:"w-full min-h-full",children:s.jsx("div",{className:"w-full max-w-7xl mx-auto px-4 md:px-6 lg:px-8 py-4 md:py-6 lg:py-8",children:s.jsx(g,{})})})})})]})]})};export{O as default};
//# sourceMappingURL=AppLayout-HJ2PARlS.js.map
