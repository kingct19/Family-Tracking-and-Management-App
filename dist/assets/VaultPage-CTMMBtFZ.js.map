{"version":3,"file":"VaultPage-CTMMBtFZ.js","sources":["../../src/lib/services/encryption-service.ts","../../src/lib/services/vault-storage.ts","../../src/features/vault/components/VaultAuthGate.tsx","../../src/features/vault/api/vault-api.ts","../../src/features/vault/components/VaultItemCard.tsx","../../src/features/vault/components/VaultItemModal.tsx","../../src/features/vault/hooks/useVault.ts","../../src/features/vault/pages/VaultPage.tsx"],"sourcesContent":["/**\n * Encryption Service\n * \n * Client-side encryption for vault items using Web Crypto API\n * AES-GCM encryption with 256-bit keys\n */\n\nconst ALGORITHM = 'AES-GCM';\nconst KEY_LENGTH = 256;\nconst IV_LENGTH = 12; // 96 bits for GCM\nconst TAG_LENGTH = 128; // 128 bits for GCM\n\n/**\n * Derive encryption key from PIN/password using PBKDF2\n */\nasync function deriveKey(\n    password: string,\n    salt: Uint8Array\n): Promise<CryptoKey> {\n    const encoder = new TextEncoder();\n    const passwordKey = await crypto.subtle.importKey(\n        'raw',\n        encoder.encode(password),\n        'PBKDF2',\n        false,\n        ['deriveBits', 'deriveKey']\n    );\n\n    return crypto.subtle.deriveKey(\n        {\n            name: 'PBKDF2',\n            salt: salt.buffer as ArrayBuffer,\n            iterations: 100000,\n            hash: 'SHA-256',\n        },\n        passwordKey,\n        {\n            name: ALGORITHM,\n            length: KEY_LENGTH,\n        },\n        false,\n        ['encrypt', 'decrypt']\n    );\n}\n\n/**\n * Generate a random salt\n */\nexport function generateSalt(): Uint8Array {\n    return crypto.getRandomValues(new Uint8Array(16));\n}\n\n/**\n * Encrypt data with a password\n */\nexport async function encrypt(\n    data: string,\n    password: string,\n    salt?: Uint8Array\n): Promise<{ ciphertext: string; salt: string; iv: string }> {\n    const dataEncoder = new TextEncoder();\n    const dataBuffer = dataEncoder.encode(data);\n\n    // Generate salt if not provided\n    const encryptionSalt = salt || generateSalt();\n\n    // Derive key from password\n    const key = await deriveKey(password, encryptionSalt);\n\n    // Generate IV\n    const iv = crypto.getRandomValues(new Uint8Array(IV_LENGTH));\n\n    // Encrypt\n    const encrypted = await crypto.subtle.encrypt(\n        {\n            name: ALGORITHM,\n            iv,\n            tagLength: TAG_LENGTH,\n        },\n        key,\n        dataBuffer\n    );\n\n    // Convert to base64 for storage\n    const ciphertext = btoa(\n        String.fromCharCode(...new Uint8Array(encrypted))\n    );\n    const saltBase64 = btoa(String.fromCharCode(...encryptionSalt));\n    const ivBase64 = btoa(String.fromCharCode(...iv));\n\n    return {\n        ciphertext,\n        salt: saltBase64,\n        iv: ivBase64,\n    };\n}\n\n/**\n * Decrypt data with a password\n */\nexport async function decrypt(\n    ciphertext: string,\n    password: string,\n    salt: string,\n    iv: string\n): Promise<string> {\n    // Convert from base64\n    const ciphertextBytes = Uint8Array.from(\n        atob(ciphertext),\n        (c) => c.charCodeAt(0)\n    );\n    const saltBytes = Uint8Array.from(atob(salt), (c) => c.charCodeAt(0));\n    const ivBytes = Uint8Array.from(atob(iv), (c) => c.charCodeAt(0));\n\n    // Derive key from password\n    const key = await deriveKey(password, saltBytes);\n\n    // Decrypt\n    const decrypted = await crypto.subtle.decrypt(\n        {\n            name: ALGORITHM,\n            iv: ivBytes,\n            tagLength: TAG_LENGTH,\n        },\n        key,\n        ciphertextBytes\n    );\n\n    // Convert to string\n    const decoder = new TextDecoder();\n    return decoder.decode(decrypted);\n}\n\n/**\n * Hash PIN for storage (using SHA-256)\n * Note: This is for PIN verification, not encryption\n */\nexport async function hashPIN(pin: string): Promise<string> {\n    const encoder = new TextEncoder();\n    const data = encoder.encode(pin);\n    const hashBuffer = await crypto.subtle.digest('SHA-256', data);\n    const hashArray = Array.from(new Uint8Array(hashBuffer));\n    return hashArray.map((b) => b.toString(16).padStart(2, '0')).join('');\n}\n\n","/**\n * Vault Storage Service\n * \n * Manages PIN storage and session state in localStorage\n * PIN hash is stored (never plain PIN)\n */\n\nconst VAULT_PIN_KEY = 'vault_pin_hash';\nconst VAULT_SESSION_KEY = 'vault_session';\nconst VAULT_SESSION_DURATION = 15 * 60 * 1000; // 15 minutes\n\n/**\n * Store PIN hash (never store plain PIN)\n */\nexport function storePINHash(pinHash: string): void {\n    localStorage.setItem(VAULT_PIN_KEY, pinHash);\n}\n\n/**\n * Get stored PIN hash\n */\nexport function getPINHash(): string | null {\n    return localStorage.getItem(VAULT_PIN_KEY);\n}\n\n/**\n * Check if PIN is set up\n */\nexport function hasPIN(): boolean {\n    return getPINHash() !== null;\n}\n\n/**\n * Clear PIN hash (for logout/reset)\n */\nexport function clearPINHash(): void {\n    localStorage.removeItem(VAULT_PIN_KEY);\n    clearVaultSession();\n}\n\n/**\n * Create vault session (user has authenticated)\n */\nexport function createVaultSession(): void {\n    const expiresAt = Date.now() + VAULT_SESSION_DURATION;\n    localStorage.setItem(VAULT_SESSION_KEY, expiresAt.toString());\n}\n\n/**\n * Check if vault session is valid\n */\nexport function isVaultSessionValid(): boolean {\n    const expiresAt = localStorage.getItem(VAULT_SESSION_KEY);\n    if (!expiresAt) return false;\n    \n    const expires = parseInt(expiresAt, 10);\n    if (Date.now() > expires) {\n        clearVaultSession();\n        return false;\n    }\n    \n    return true;\n}\n\n/**\n * Clear vault session\n */\nexport function clearVaultSession(): void {\n    localStorage.removeItem(VAULT_SESSION_KEY);\n}\n\n/**\n * Extend vault session\n */\nexport function extendVaultSession(): void {\n    if (isVaultSessionValid()) {\n        createVaultSession();\n    }\n}\n\n","/**\n * VaultAuthGate Component\n * \n * PIN/biometric authentication gate for vault access\n */\n\nimport { useState, useEffect } from 'react';\nimport { FiLock, FiEye, FiEyeOff, FiKey, FiShield } from 'react-icons/fi';\nimport { Button } from '@/components/ui/Button';\nimport { TextField } from '@/components/ui/TextField';\nimport { hashPIN } from '@/lib/services/encryption-service';\nimport { storePINHash, getPINHash, createVaultSession, hasPIN } from '@/lib/services/vault-storage';\nimport toast from 'react-hot-toast';\n\ninterface VaultAuthGateProps {\n    onAuthenticated: (pin?: string) => void;\n    onSetupComplete?: () => void;\n}\n\nexport const VaultAuthGate = ({ onAuthenticated, onSetupComplete }: VaultAuthGateProps) => {\n    const [pin, setPin] = useState('');\n    const [confirmPin, setConfirmPin] = useState('');\n    const [showPin, setShowPin] = useState(false);\n    const [isSettingUp, setIsSettingUp] = useState(false);\n    const [isAuthenticating, setIsAuthenticating] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n\n    const pinExists = hasPIN();\n\n    useEffect(() => {\n        // Check if session is still valid\n        const checkSession = () => {\n            const sessionValid = localStorage.getItem('vault_session');\n            if (sessionValid && parseInt(sessionValid) > Date.now()) {\n                onAuthenticated();\n            }\n        };\n        checkSession();\n    }, [onAuthenticated]);\n\n    const handleSetupPIN = async () => {\n        setError(null);\n\n        // Validate PIN\n        if (pin.length < 4) {\n            setError('PIN must be at least 4 digits');\n            return;\n        }\n\n        if (pin.length > 8) {\n            setError('PIN must be no more than 8 digits');\n            return;\n        }\n\n        if (!/^\\d+$/.test(pin)) {\n            setError('PIN must contain only numbers');\n            return;\n        }\n\n        if (pin !== confirmPin) {\n            setError('PINs do not match');\n            return;\n        }\n\n        setIsSettingUp(true);\n        try {\n            // Hash and store PIN\n            const pinHash = await hashPIN(pin);\n            storePINHash(pinHash);\n            createVaultSession();\n            \n            toast.success('Vault PIN set up successfully');\n            const setupPin = pin; // Save PIN before clearing\n            setPin('');\n            setConfirmPin('');\n            onSetupComplete?.();\n            onAuthenticated(setupPin);\n        } catch (err) {\n            console.error('Failed to set up PIN:', err);\n            setError('Failed to set up PIN. Please try again.');\n        } finally {\n            setIsSettingUp(false);\n        }\n    };\n\n    const handleAuthenticate = async () => {\n        setError(null);\n\n        if (pin.length < 4) {\n            setError('Please enter your PIN');\n            return;\n        }\n\n        setIsAuthenticating(true);\n        try {\n            // Hash entered PIN and compare with stored hash\n            const enteredPinHash = await hashPIN(pin);\n            const storedPinHash = getPINHash();\n\n            if (enteredPinHash !== storedPinHash) {\n                setError('Incorrect PIN. Please try again.');\n                setPin('');\n                return;\n            }\n\n            // Create session\n            createVaultSession();\n            toast.success('Vault unlocked');\n            const authPin = pin; // Save PIN before clearing\n            setPin('');\n            onAuthenticated(authPin);\n        } catch (err) {\n            console.error('Authentication error:', err);\n            setError('Authentication failed. Please try again.');\n        } finally {\n            setIsAuthenticating(false);\n        }\n    };\n\n    const handleBiometricAuth = async () => {\n        // Check if WebAuthn is available\n        if (!window.PublicKeyCredential) {\n            toast.error('Biometric authentication not available on this device');\n            return;\n        }\n\n        try {\n            // For now, we'll use a simple prompt\n            // In production, implement proper WebAuthn API\n            toast('Biometric authentication coming soon', { icon: 'üîê' });\n        } catch (err) {\n            console.error('Biometric auth error:', err);\n            toast.error('Biometric authentication failed');\n        }\n    };\n\n    return (\n        <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-50 via-indigo-50 to-blue-50 p-4\">\n            <div className=\"w-full max-w-md\">\n                <div className=\"bg-white rounded-3xl shadow-2xl p-8 md:p-10\">\n                    {/* Header */}\n                    <div className=\"text-center mb-8\">\n                        <div className=\"w-20 h-20 bg-gradient-to-br from-purple-600 to-indigo-600 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg\">\n                            <FiLock size={32} className=\"text-white\" />\n                        </div>\n                        <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">\n                            {pinExists ? 'Unlock Vault' : 'Set Up Vault'}\n                        </h1>\n                        <p className=\"text-gray-600\">\n                            {pinExists\n                                ? 'Enter your PIN to access your secure vault'\n                                : 'Create a PIN to secure your vault (4-8 digits)'}\n                        </p>\n                    </div>\n\n                    {/* Encryption Badge */}\n                    <div className=\"mb-6 flex items-center justify-center gap-2 text-sm text-green-700 bg-green-50 rounded-xl px-4 py-2\">\n                        <FiShield size={16} />\n                        <span className=\"font-medium\">AES-256 Encrypted</span>\n                    </div>\n\n                    {/* Error Message */}\n                    {error && (\n                        <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm\">\n                            {error}\n                        </div>\n                    )}\n\n                    {/* PIN Input */}\n                    <div className=\"space-y-4 mb-6\">\n                        <div>\n                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">\n                                PIN\n                            </label>\n                            <div className=\"relative\">\n                                <TextField\n                                    type={showPin ? 'text' : 'password'}\n                                    value={pin}\n                                    onChange={(e) => {\n                                        setPin(e.target.value);\n                                        setError(null);\n                                    }}\n                                    placeholder={pinExists ? 'Enter your PIN' : 'Enter PIN (4-8 digits)'}\n                                    fullWidth\n                                    maxLength={8}\n                                    inputMode=\"numeric\"\n                                    pattern=\"[0-9]*\"\n                                    startAdornment={<FiLock size={20} className=\"text-gray-400\" />}\n                                    endAdornment={\n                                        <button\n                                            type=\"button\"\n                                            onClick={() => setShowPin(!showPin)}\n                                            className=\"p-2 text-gray-400 hover:text-gray-600\"\n                                            aria-label={showPin ? 'Hide PIN' : 'Show PIN'}\n                                        >\n                                            {showPin ? <FiEyeOff size={20} /> : <FiEye size={20} />}\n                                        </button>\n                                    }\n                                    autoFocus\n                                    onKeyDown={(e) => {\n                                        if (e.key === 'Enter') {\n                                            if (pinExists) {\n                                                handleAuthenticate();\n                                            } else {\n                                                handleSetupPIN();\n                                            }\n                                        }\n                                    }}\n                                />\n                            </div>\n                        </div>\n\n                        {/* Confirm PIN (only during setup) */}\n                        {!pinExists && (\n                            <div>\n                                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">\n                                    Confirm PIN\n                                </label>\n                                <TextField\n                                    type={showPin ? 'text' : 'password'}\n                                    value={confirmPin}\n                                    onChange={(e) => {\n                                        setConfirmPin(e.target.value);\n                                        setError(null);\n                                    }}\n                                    placeholder=\"Confirm PIN\"\n                                    fullWidth\n                                    maxLength={8}\n                                    inputMode=\"numeric\"\n                                    pattern=\"[0-9]*\"\n                                    startAdornment={<FiLock size={20} className=\"text-gray-400\" />}\n                                    onKeyDown={(e) => {\n                                        if (e.key === 'Enter') {\n                                            handleSetupPIN();\n                                        }\n                                    }}\n                                />\n                            </div>\n                        )}\n                    </div>\n\n                    {/* Action Buttons */}\n                    <div className=\"space-y-3\">\n                        {pinExists ? (\n                            <>\n                                <Button\n                                    variant=\"filled\"\n                                    size=\"large\"\n                                    fullWidth\n                                    onClick={handleAuthenticate}\n                                    disabled={isAuthenticating || pin.length < 4}\n                                    loading={isAuthenticating}\n                                >\n                                    Unlock Vault\n                                </Button>\n                                {window.PublicKeyCredential && (\n                                    <Button\n                                        variant=\"outlined\"\n                                        size=\"large\"\n                                        fullWidth\n                                        onClick={handleBiometricAuth}\n                                        startIcon={<FiKey size={20} />}\n                                    >\n                                        Use Biometric\n                                    </Button>\n                                )}\n                            </>\n                        ) : (\n                            <Button\n                                variant=\"filled\"\n                                size=\"large\"\n                                fullWidth\n                                onClick={handleSetupPIN}\n                                disabled={isSettingUp || pin.length < 4 || pin !== confirmPin}\n                                loading={isSettingUp}\n                            >\n                                Set Up Vault\n                            </Button>\n                        )}\n                    </div>\n\n                    {/* Security Info */}\n                    <div className=\"mt-6 pt-6 border-t border-gray-200\">\n                        <div className=\"text-xs text-gray-500 space-y-1\">\n                            <p className=\"flex items-center gap-2\">\n                                <FiShield size={12} />\n                                Your PIN is hashed and never stored in plain text\n                            </p>\n                            <p className=\"flex items-center gap-2\">\n                                <FiLock size={12} />\n                                All vault data is encrypted with AES-256\n                            </p>\n                            <p className=\"flex items-center gap-2\">\n                                <FiLock size={12} />\n                                Session expires after 15 minutes of inactivity\n                            </p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n\n","/**\n * Vault API\n * \n * CRUD operations for vault items\n * All data is encrypted client-side before storage\n */\n\nimport {\n    doc,\n    getDoc,\n    setDoc,\n    updateDoc,\n    deleteDoc,\n    collection,\n    query,\n    where,\n    orderBy,\n    getDocs,\n    serverTimestamp,\n} from 'firebase/firestore';\nimport { db } from '@/config/firebase';\nimport type { VaultItem, ApiResponse } from '@/types';\nimport { encrypt, decrypt } from '@/lib/services/encryption-service';\nimport { isVaultSessionValid, extendVaultSession } from '@/lib/services/vault-storage';\n\n/**\n * Create a new vault item\n */\nexport const createVaultItem = async (\n    userId: string,\n    data: {\n        type: VaultItem['type'];\n        title: string;\n        content: string; // Plain text content to encrypt\n        metadata?: Partial<VaultItem['metadata']>;\n    },\n    encryptionKey: string // User's PIN/password for encryption\n): Promise<ApiResponse<VaultItem>> => {\n    try {\n        // Check session\n        if (!isVaultSessionValid()) {\n            return {\n                success: false,\n                error: 'Vault session expired. Please authenticate again.',\n            };\n        }\n\n        // Encrypt content\n        const { ciphertext, salt, iv } = await encrypt(data.content, encryptionKey);\n\n        const vaultRef = doc(collection(db, 'vault', userId, 'items'));\n\n        const vaultItem: Omit<VaultItem, 'id' | 'createdAt' | 'updatedAt'> = {\n            userId,\n            type: data.type,\n            title: data.title,\n            ciphertext,\n            metadata: {\n                icon: data.metadata?.icon,\n                category: data.metadata?.category,\n                tags: data.metadata?.tags || [],\n                favorite: data.metadata?.favorite || false,\n            },\n        };\n\n        // Store salt and iv separately (needed for decryption)\n        await setDoc(vaultRef, {\n            ...vaultItem,\n            salt, // Store salt separately\n            iv, // Store iv separately\n            createdAt: serverTimestamp(),\n            updatedAt: serverTimestamp(),\n        });\n\n        extendVaultSession();\n\n        // Fetch the created document to return complete data\n        const createdDoc = await getDoc(vaultRef);\n        const createdData = createdDoc.data();\n        \n        return {\n            success: true,\n            data: {\n                id: vaultRef.id,\n                ...vaultItem,\n                createdAt: createdData?.createdAt?.toDate() || new Date(),\n                updatedAt: createdData?.updatedAt?.toDate() || new Date(),\n            } as VaultItem,\n        };\n    } catch (error: any) {\n        console.error('Create vault item error:', error);\n        return {\n            success: false,\n            error: 'Failed to create vault item',\n        };\n    }\n};\n\n/**\n * Get all vault items for a user\n */\nexport const getUserVaultItems = async (\n    userId: string\n): Promise<ApiResponse<VaultItem[]>> => {\n    try {\n        if (!isVaultSessionValid()) {\n            return {\n                success: false,\n                error: 'Vault session expired. Please authenticate again.',\n            };\n        }\n\n        const vaultQuery = query(\n            collection(db, 'vault', userId, 'items'),\n            orderBy('updatedAt', 'desc')\n        );\n        const snapshot = await getDocs(vaultQuery);\n\n        const items: VaultItem[] = [];\n        snapshot.forEach((docSnap) => {\n            const data = docSnap.data();\n            items.push({\n                id: docSnap.id,\n                userId: data.userId,\n                type: data.type,\n                title: data.title,\n                ciphertext: data.ciphertext,\n                metadata: {\n                    ...data.metadata,\n                    // Store salt/iv in metadata for decryption\n                    salt: data.salt,\n                    iv: data.iv,\n                } as any,\n                createdAt: data.createdAt?.toDate() || new Date(),\n                updatedAt: data.updatedAt?.toDate() || new Date(),\n                accessedAt: data.accessedAt?.toDate(),\n            });\n        });\n\n        extendVaultSession();\n\n        return {\n            success: true,\n            data: items,\n        };\n    } catch (error: any) {\n        console.error('Get vault items error:', error);\n        return {\n            success: false,\n            error: 'Failed to fetch vault items',\n        };\n    }\n};\n\n/**\n * Get a single vault item\n */\nexport const getVaultItem = async (\n    userId: string,\n    itemId: string\n): Promise<ApiResponse<VaultItem>> => {\n    try {\n        if (!isVaultSessionValid()) {\n            return {\n                success: false,\n                error: 'Vault session expired. Please authenticate again.',\n            };\n        }\n\n        const itemDoc = await getDoc(doc(db, 'vault', userId, 'items', itemId));\n\n        if (!itemDoc.exists()) {\n            return {\n                success: false,\n                error: 'Vault item not found',\n            };\n        }\n\n        const data = itemDoc.data();\n        const item: VaultItem = {\n            id: itemDoc.id,\n            userId: data.userId,\n            type: data.type,\n            title: data.title,\n            ciphertext: data.ciphertext,\n            metadata: {\n                ...data.metadata,\n                // Store salt/iv in metadata for decryption\n                salt: data.salt,\n                iv: data.iv,\n            } as any,\n            createdAt: data.createdAt?.toDate() || new Date(),\n            updatedAt: data.updatedAt?.toDate() || new Date(),\n            accessedAt: data.accessedAt?.toDate(),\n        };\n\n        // Update accessedAt\n        await updateDoc(doc(db, 'vault', userId, 'items', itemId), {\n            accessedAt: serverTimestamp(),\n        });\n\n        extendVaultSession();\n\n        return {\n            success: true,\n            data: item,\n        };\n    } catch (error: any) {\n        console.error('Get vault item error:', error);\n        return {\n            success: false,\n            error: 'Failed to fetch vault item',\n        };\n    }\n};\n\n/**\n * Update a vault item\n */\nexport const updateVaultItem = async (\n    userId: string,\n    itemId: string,\n    updates: {\n        title?: string;\n        content?: string; // Plain text content to encrypt\n        metadata?: Partial<VaultItem['metadata']>;\n    },\n    encryptionKey: string\n): Promise<ApiResponse<void>> => {\n    try {\n        if (!isVaultSessionValid()) {\n            return {\n                success: false,\n                error: 'Vault session expired. Please authenticate again.',\n            };\n        }\n\n        const updateData: any = {\n            updatedAt: serverTimestamp(),\n        };\n\n        // Get existing item once for salt/iv and metadata merge\n        const itemResponse = await getVaultItem(userId, itemId);\n        if (!itemResponse.success || !itemResponse.data) {\n            return {\n                success: false,\n                error: 'Failed to get vault item for update',\n            };\n        }\n\n        const existingItem = itemResponse.data;\n        const existingMetadata = existingItem.metadata as any;\n\n        if (updates.title !== undefined) {\n            updateData.title = updates.title;\n        }\n\n        if (updates.content !== undefined) {\n            const salt = existingMetadata.salt;\n            const iv = existingMetadata.iv;\n\n            // Re-encrypt with new content (reuse salt/iv for same item)\n            const { ciphertext } = await encrypt(updates.content, encryptionKey, \n                Uint8Array.from(atob(salt), (c) => c.charCodeAt(0))\n            );\n            updateData.ciphertext = ciphertext;\n        }\n\n        if (updates.metadata !== undefined) {\n            updateData.metadata = {\n                ...existingItem.metadata,\n                ...updates.metadata,\n                // Preserve salt/iv\n                salt: existingMetadata.salt,\n                iv: existingMetadata.iv,\n            } as any;\n        }\n\n        await updateDoc(doc(db, 'vault', userId, 'items', itemId), updateData);\n\n        extendVaultSession();\n\n        return { success: true };\n    } catch (error: any) {\n        console.error('Update vault item error:', error);\n        return {\n            success: false,\n            error: 'Failed to update vault item',\n        };\n    }\n};\n\n/**\n * Delete a vault item\n */\nexport const deleteVaultItem = async (\n    userId: string,\n    itemId: string\n): Promise<ApiResponse<void>> => {\n    try {\n        if (!isVaultSessionValid()) {\n            return {\n                success: false,\n                error: 'Vault session expired. Please authenticate again.',\n            };\n        }\n\n        await deleteDoc(doc(db, 'vault', userId, 'items', itemId));\n\n        extendVaultSession();\n\n        return { success: true };\n    } catch (error: any) {\n        console.error('Delete vault item error:', error);\n        return {\n            success: false,\n            error: 'Failed to delete vault item',\n        };\n    }\n};\n\n/**\n * Decrypt vault item content\n */\nexport const decryptVaultItem = async (\n    item: VaultItem,\n    encryptionKey: string\n): Promise<string> => {\n    // Get salt and iv from metadata (stored there for decryption)\n    const metadata = item.metadata as any;\n    const salt = metadata.salt;\n    const iv = metadata.iv;\n    \n    if (!salt || !iv) {\n        throw new Error('Missing encryption parameters');\n    }\n    \n    return decrypt(item.ciphertext, encryptionKey, salt, iv);\n};\n\n","/**\n * VaultItemCard Component\n * \n * Card display for vault items\n */\n\nimport { useState } from 'react';\nimport { FiLock, FiEye, FiEyeOff, FiEdit2, FiTrash2, FiStar, FiCopy, FiCheck } from 'react-icons/fi';\nimport type { VaultItem } from '@/types';\nimport { decryptVaultItem } from '../api/vault-api';\nimport { isVaultSessionValid } from '@/lib/services/vault-storage';\nimport toast from 'react-hot-toast';\n\ninterface VaultItemCardProps {\n    item: VaultItem;\n    encryptionKey: string;\n    onEdit: (item: VaultItem, decryptedContent: string) => void;\n    onDelete: (itemId: string) => void;\n}\n\nconst typeIcons: Record<VaultItem['type'], string> = {\n    password: 'üîê',\n    note: 'üìù',\n    card: 'üí≥',\n    identity: 'üÜî',\n    document: 'üìÑ',\n};\n\nexport const VaultItemCard = ({ item, encryptionKey, onEdit, onDelete }: VaultItemCardProps) => {\n    const [decryptedContent, setDecryptedContent] = useState<string | null>(null);\n    const [isDecrypting, setIsDecrypting] = useState(false);\n    const [isRevealed, setIsRevealed] = useState(false);\n    const [copied, setCopied] = useState(false);\n\n    const handleReveal = async () => {\n        if (!isVaultSessionValid()) {\n            toast.error('Session expired. Please unlock vault again.');\n            return;\n        }\n\n        if (decryptedContent) {\n            setIsRevealed(!isRevealed);\n            return;\n        }\n\n        setIsDecrypting(true);\n        try {\n            const content = await decryptVaultItem(item, encryptionKey);\n            setDecryptedContent(content);\n            setIsRevealed(true);\n        } catch (error) {\n            console.error('Decryption error:', error);\n            toast.error('Failed to decrypt item');\n        } finally {\n            setIsDecrypting(false);\n        }\n    };\n\n    const handleCopy = async () => {\n        if (!decryptedContent) {\n            await handleReveal();\n            return;\n        }\n\n        try {\n            await navigator.clipboard.writeText(decryptedContent);\n            setCopied(true);\n            toast.success('Copied to clipboard');\n            setTimeout(() => setCopied(false), 2000);\n        } catch (error) {\n            toast.error('Failed to copy');\n        }\n    };\n\n    return (\n        <div className=\"bg-white rounded-xl p-6 shadow-lg border border-gray-200 hover:shadow-xl transition-all duration-200\">\n            <div className=\"flex items-start justify-between mb-4\">\n                <div className=\"flex items-center gap-3\">\n                    <div className=\"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center text-2xl\">\n                        {typeIcons[item.type]}\n                    </div>\n                    <div>\n                        <h3 className=\"font-bold text-gray-900 flex items-center gap-2\">\n                            {item.title}\n                            {item.metadata.favorite && (\n                                <FiStar size={16} className=\"text-yellow-500 fill-yellow-500\" />\n                            )}\n                        </h3>\n                        <p className=\"text-sm text-gray-500 capitalize\">{item.type}</p>\n                    </div>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                    <button\n                        onClick={() => onEdit(item, decryptedContent || '')}\n                        className=\"p-2 text-gray-400 hover:text-purple-600 hover:bg-purple-50 rounded-lg transition-colors\"\n                        aria-label=\"Edit item\"\n                    >\n                        <FiEdit2 size={18} />\n                    </button>\n                    <button\n                        onClick={() => onDelete(item.id)}\n                        className=\"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors\"\n                        aria-label=\"Delete item\"\n                    >\n                        <FiTrash2 size={18} />\n                    </button>\n                </div>\n            </div>\n\n            {/* Content Preview */}\n            <div className=\"mb-4\">\n                {isRevealed && decryptedContent ? (\n                    <div className=\"bg-gray-50 rounded-lg p-3 border border-gray-200\">\n                        <p className=\"text-sm text-gray-700 font-mono break-all\">\n                            {decryptedContent}\n                        </p>\n                    </div>\n                ) : (\n                    <div className=\"bg-gray-50 rounded-lg p-3 border border-gray-200 flex items-center gap-2\">\n                        <FiLock size={16} className=\"text-gray-400\" />\n                        <span className=\"text-sm text-gray-500\">\n                            {isDecrypting ? 'Decrypting...' : '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢'}\n                        </span>\n                    </div>\n                )}\n            </div>\n\n            {/* Tags */}\n            {item.metadata.tags && item.metadata.tags.length > 0 && (\n                <div className=\"flex flex-wrap gap-2 mb-4\">\n                    {item.metadata.tags.map((tag) => (\n                        <span\n                            key={tag}\n                            className=\"px-2 py-1 bg-purple-50 text-purple-700 rounded-md text-xs font-medium\"\n                        >\n                            {tag}\n                        </span>\n                    ))}\n                </div>\n            )}\n\n            {/* Actions */}\n            <div className=\"flex items-center gap-2 pt-4 border-t border-gray-100\">\n                <button\n                    onClick={handleReveal}\n                    disabled={isDecrypting}\n                    className=\"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-purple-50 text-purple-700 rounded-lg hover:bg-purple-100 transition-colors text-sm font-medium disabled:opacity-50\"\n                >\n                    {isRevealed ? (\n                        <>\n                            <FiEyeOff size={16} />\n                            Hide\n                        </>\n                    ) : (\n                        <>\n                            <FiEye size={16} />\n                            Reveal\n                        </>\n                    )}\n                </button>\n                <button\n                    onClick={handleCopy}\n                    className=\"flex items-center justify-center gap-2 px-4 py-2 bg-gray-50 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors text-sm font-medium\"\n                    aria-label=\"Copy content\"\n                >\n                    {copied ? <FiCheck size={16} /> : <FiCopy size={16} />}\n                </button>\n            </div>\n\n            {/* Metadata */}\n            <div className=\"mt-3 pt-3 border-t border-gray-100 text-xs text-gray-500\">\n                <p>Updated {new Date(item.updatedAt).toLocaleDateString()}</p>\n            </div>\n        </div>\n    );\n};\n\n","/**\n * VaultItemModal Component\n * \n * Modal for creating/editing vault items\n */\n\nimport { useState, useEffect } from 'react';\nimport { FiX, FiLock, FiEye, FiEyeOff, FiStar, FiTag } from 'react-icons/fi';\nimport { Button } from '@/components/ui/Button';\nimport { TextField } from '@/components/ui/TextField';\nimport type { VaultItem, VaultItemType } from '@/types';\n\ninterface VaultItemModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onSave: (data: {\n        type: VaultItemType;\n        title: string;\n        content: string;\n        metadata?: Partial<VaultItem['metadata']>;\n    }) => Promise<void>;\n    item?: VaultItem | null;\n    decryptedContent?: string;\n    isLoading?: boolean;\n}\n\nconst vaultTypes: Array<{ value: VaultItemType; label: string; icon: string }> = [\n    { value: 'password', label: 'Password', icon: 'üîê' },\n    { value: 'note', label: 'Secure Note', icon: 'üìù' },\n    { value: 'card', label: 'Credit Card', icon: 'üí≥' },\n    { value: 'identity', label: 'Identity', icon: 'üÜî' },\n    { value: 'document', label: 'Document', icon: 'üìÑ' },\n];\n\nexport const VaultItemModal = ({\n    isOpen,\n    onClose,\n    onSave,\n    item,\n    decryptedContent,\n    isLoading = false,\n}: VaultItemModalProps) => {\n    const [formData, setFormData] = useState({\n        type: 'password' as VaultItemType,\n        title: '',\n        content: '',\n        favorite: false,\n        tags: [] as string[],\n    });\n    const [showContent, setShowContent] = useState(false);\n    const [tagInput, setTagInput] = useState('');\n    const [errors, setErrors] = useState<Record<string, string>>({});\n\n    useEffect(() => {\n        if (isOpen) {\n            if (item && decryptedContent) {\n                setFormData({\n                    type: item.type,\n                    title: item.title,\n                    content: decryptedContent,\n                    favorite: item.metadata.favorite,\n                    tags: item.metadata.tags || [],\n                });\n            } else {\n                setFormData({\n                    type: 'password',\n                    title: '',\n                    content: '',\n                    favorite: false,\n                    tags: [],\n                });\n            }\n            setErrors({});\n            setShowContent(false);\n        }\n    }, [isOpen, item, decryptedContent]);\n\n    const handleChange = (field: string, value: any) => {\n        setFormData((prev) => ({ ...prev, [field]: value }));\n        if (errors[field]) {\n            setErrors((prev) => {\n                const newErrors = { ...prev };\n                delete newErrors[field];\n                return newErrors;\n            });\n        }\n    };\n\n    const handleAddTag = () => {\n        if (tagInput.trim() && !formData.tags.includes(tagInput.trim())) {\n            handleChange('tags', [...formData.tags, tagInput.trim()]);\n            setTagInput('');\n        }\n    };\n\n    const handleRemoveTag = (tag: string) => {\n        handleChange('tags', formData.tags.filter((t) => t !== tag));\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        const newErrors: Record<string, string> = {};\n\n        if (!formData.title.trim()) {\n            newErrors.title = 'Title is required';\n        }\n\n        if (!formData.content.trim()) {\n            newErrors.content = 'Content is required';\n        }\n\n        if (Object.keys(newErrors).length > 0) {\n            setErrors(newErrors);\n            return;\n        }\n\n        try {\n            await onSave({\n                type: formData.type,\n                title: formData.title.trim(),\n                content: formData.content.trim(),\n                metadata: {\n                    favorite: formData.favorite,\n                    tags: formData.tags,\n                },\n            });\n            onClose();\n        } catch (error) {\n            // Error handling done in parent\n        }\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <div\n            className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm\"\n            onClick={onClose}\n        >\n            <div\n                className=\"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col animate-slide-up\"\n                onClick={(e) => e.stopPropagation()}\n            >\n                {/* Header */}\n                <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\n                    <h2 className=\"text-2xl font-bold text-gray-900\">\n                        {item ? 'Edit Vault Item' : 'Create Vault Item'}\n                    </h2>\n                    <button\n                        onClick={onClose}\n                        className=\"p-2 rounded-full hover:bg-gray-100 transition-colors\"\n                        aria-label=\"Close\"\n                    >\n                        <FiX size={24} className=\"text-gray-600\" />\n                    </button>\n                </div>\n\n                {/* Form */}\n                <form onSubmit={handleSubmit} className=\"flex-1 overflow-y-auto p-6\">\n                    <div className=\"space-y-6\">\n                        {/* Type */}\n                        <div>\n                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">\n                                Type\n                            </label>\n                            <div className=\"grid grid-cols-5 gap-2\">\n                                {vaultTypes.map((type) => (\n                                    <button\n                                        key={type.value}\n                                        type=\"button\"\n                                        onClick={() => handleChange('type', type.value)}\n                                        className={`p-3 rounded-xl border-2 transition-all ${\n                                            formData.type === type.value\n                                                ? 'border-purple-500 bg-purple-50'\n                                                : 'border-gray-200 hover:border-gray-300'\n                                        }`}\n                                    >\n                                        <div className=\"text-2xl mb-1\">{type.icon}</div>\n                                        <div className=\"text-xs font-medium text-gray-700\">\n                                            {type.label}\n                                        </div>\n                                    </button>\n                                ))}\n                            </div>\n                        </div>\n\n                        {/* Title */}\n                        <TextField\n                            label=\"Title\"\n                            value={formData.title}\n                            onChange={(e) => handleChange('title', e.target.value)}\n                            placeholder=\"Enter item title\"\n                            required\n                            error={errors.title}\n                            fullWidth\n                        />\n\n                        {/* Content */}\n                        <div>\n                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">\n                                Content\n                            </label>\n                            <div className=\"relative\">\n                                <textarea\n                                    value={formData.content}\n                                    onChange={(e) => handleChange('content', e.target.value)}\n                                    placeholder={\n                                        formData.type === 'password'\n                                            ? 'Enter password'\n                                            : formData.type === 'card'\n                                            ? 'Enter card details'\n                                            : 'Enter content'\n                                    }\n                                    rows={formData.type === 'note' ? 8 : 4}\n                                    className={`w-full px-4 py-3 pr-12 rounded-xl border-2 transition-colors ${\n                                        errors.content\n                                            ? 'border-red-300 focus:border-red-500'\n                                            : 'border-gray-200 focus:border-purple-500'\n                                    } focus:outline-none focus:ring-2 focus:ring-purple-500`}\n                                />\n                                <button\n                                    type=\"button\"\n                                    onClick={() => setShowContent(!showContent)}\n                                    className=\"absolute right-3 top-3 p-2 text-gray-400 hover:text-gray-600\"\n                                    aria-label={showContent ? 'Hide content' : 'Show content'}\n                                >\n                                    {showContent ? <FiEyeOff size={20} /> : <FiEye size={20} />}\n                                </button>\n                            </div>\n                            {errors.content && (\n                                <p className=\"mt-1 text-sm text-red-600\">{errors.content}</p>\n                            )}\n                            <p className=\"mt-1 text-xs text-gray-500\">\n                                This content will be encrypted before storage\n                            </p>\n                        </div>\n\n                        {/* Tags */}\n                        <div>\n                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">\n                                Tags\n                            </label>\n                            <div className=\"flex gap-2 mb-2\">\n                                <TextField\n                                    value={tagInput}\n                                    onChange={(e) => setTagInput(e.target.value)}\n                                    placeholder=\"Add tag\"\n                                    onKeyDown={(e) => {\n                                        if (e.key === 'Enter') {\n                                            e.preventDefault();\n                                            handleAddTag();\n                                        }\n                                    }}\n                                    startAdornment={<FiTag size={16} className=\"text-gray-400\" />}\n                                    className=\"flex-1\"\n                                />\n                                <Button\n                                    type=\"button\"\n                                    variant=\"outlined\"\n                                    onClick={handleAddTag}\n                                    disabled={!tagInput.trim()}\n                                >\n                                    Add\n                                </Button>\n                            </div>\n                            {formData.tags.length > 0 && (\n                                <div className=\"flex flex-wrap gap-2\">\n                                    {formData.tags.map((tag) => (\n                                        <span\n                                            key={tag}\n                                            className=\"inline-flex items-center gap-1 px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm\"\n                                        >\n                                            {tag}\n                                            <button\n                                                type=\"button\"\n                                                onClick={() => handleRemoveTag(tag)}\n                                                className=\"hover:text-purple-900\"\n                                            >\n                                                √ó\n                                            </button>\n                                        </span>\n                                    ))}\n                                </div>\n                            )}\n                        </div>\n\n                        {/* Favorite */}\n                        <div className=\"flex items-center gap-2\">\n                            <input\n                                type=\"checkbox\"\n                                id=\"favorite\"\n                                checked={formData.favorite}\n                                onChange={(e) => handleChange('favorite', e.target.checked)}\n                                className=\"w-5 h-5 rounded border-gray-300 text-purple-600 focus:ring-purple-500\"\n                            />\n                            <label htmlFor=\"favorite\" className=\"flex items-center gap-2 cursor-pointer\">\n                                <FiStar\n                                    size={16}\n                                    className={formData.favorite ? 'text-yellow-500 fill-yellow-500' : 'text-gray-400'}\n                                />\n                                <span className=\"text-sm font-medium text-gray-700\">Mark as favorite</span>\n                            </label>\n                        </div>\n                    </div>\n                </form>\n\n                {/* Footer */}\n                <div className=\"flex items-center justify-end gap-3 p-6 border-t border-gray-200 bg-gray-50\">\n                    <Button variant=\"outlined\" onClick={onClose} disabled={isLoading}>\n                        Cancel\n                    </Button>\n                    <Button\n                        variant=\"filled\"\n                        onClick={handleSubmit}\n                        disabled={isLoading}\n                        loading={isLoading}\n                    >\n                        {isLoading ? 'Saving...' : item ? 'Save Changes' : 'Create Item'}\n                    </Button>\n                </div>\n            </div>\n        </div>\n    );\n};\n\n","/**\n * Vault Hooks\n * \n * React hooks for vault operations\n */\n\nimport { useState, useCallback } from 'react';\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport { useAuth } from '@/features/auth/hooks/useAuth';\nimport {\n    createVaultItem,\n    getUserVaultItems,\n    getVaultItem,\n    updateVaultItem,\n    deleteVaultItem,\n    decryptVaultItem,\n} from '../api/vault-api';\nimport { isVaultSessionValid, clearVaultSession } from '@/lib/services/vault-storage';\nimport toast from 'react-hot-toast';\nimport type { VaultItem } from '@/types';\n\n/**\n * Hook to get user's vault items\n */\nexport const useVaultItems = () => {\n    const { user } = useAuth();\n\n    return useQuery({\n        queryKey: ['vault-items', user?.id],\n        queryFn: async () => {\n            if (!user) throw new Error('User not authenticated');\n            if (!isVaultSessionValid()) {\n                throw new Error('Vault session expired');\n            }\n            const response = await getUserVaultItems(user.id);\n            if (!response.success) throw new Error(response.error);\n            return response.data || [];\n        },\n        enabled: !!user && isVaultSessionValid(),\n        staleTime: 30 * 1000, // 30 seconds\n    });\n};\n\n/**\n * Hook to create vault item\n */\nexport const useCreateVaultItem = () => {\n    const queryClient = useQueryClient();\n    const { user } = useAuth();\n    const [encryptionKey, setEncryptionKey] = useState<string | null>(null);\n\n    const setKey = useCallback((key: string) => {\n        setEncryptionKey(key);\n    }, []);\n\n    const mutation = useMutation({\n        mutationFn: async (data: {\n            type: VaultItem['type'];\n            title: string;\n            content: string;\n            metadata?: Partial<VaultItem['metadata']>;\n        }) => {\n            if (!user || !encryptionKey) {\n                throw new Error('User or encryption key not available');\n            }\n            const response = await createVaultItem(user.id, data, encryptionKey);\n            if (!response.success) throw new Error(response.error);\n            return response.data!;\n        },\n        onSuccess: () => {\n            queryClient.invalidateQueries({ queryKey: ['vault-items', user?.id] });\n            toast.success('Vault item created');\n        },\n        onError: (error: Error) => {\n            toast.error(error.message || 'Failed to create vault item');\n        },\n    });\n\n    return {\n        ...mutation,\n        setEncryptionKey: setKey,\n    };\n};\n\n/**\n * Hook to update vault item\n */\nexport const useUpdateVaultItem = () => {\n    const queryClient = useQueryClient();\n    const { user } = useAuth();\n    const [encryptionKey, setEncryptionKey] = useState<string | null>(null);\n\n    const setKey = useCallback((key: string) => {\n        setEncryptionKey(key);\n    }, []);\n\n    const mutation = useMutation({\n        mutationFn: async ({\n            itemId,\n            updates,\n        }: {\n            itemId: string;\n            updates: {\n                title?: string;\n                content?: string;\n                metadata?: Partial<VaultItem['metadata']>;\n            };\n        }) => {\n            if (!user || !encryptionKey) {\n                throw new Error('User or encryption key not available');\n            }\n            const response = await updateVaultItem(user.id, itemId, updates, encryptionKey);\n            if (!response.success) throw new Error(response.error);\n        },\n        onSuccess: () => {\n            queryClient.invalidateQueries({ queryKey: ['vault-items', user?.id] });\n            toast.success('Vault item updated');\n        },\n        onError: (error: Error) => {\n            toast.error(error.message || 'Failed to update vault item');\n        },\n    });\n\n    return {\n        ...mutation,\n        setEncryptionKey: setKey,\n    };\n};\n\n/**\n * Hook to delete vault item\n */\nexport const useDeleteVaultItem = () => {\n    const queryClient = useQueryClient();\n    const { user } = useAuth();\n\n    return useMutation({\n        mutationFn: async (itemId: string) => {\n            if (!user) throw new Error('User not authenticated');\n            const response = await deleteVaultItem(user.id, itemId);\n            if (!response.success) throw new Error(response.error);\n        },\n        onSuccess: () => {\n            queryClient.invalidateQueries({ queryKey: ['vault-items', user?.id] });\n            toast.success('Vault item deleted');\n        },\n        onError: (error: Error) => {\n            toast.error(error.message || 'Failed to delete vault item');\n        },\n    });\n};\n\n/**\n * Hook to decrypt vault item content\n */\nexport const useDecryptVaultItem = () => {\n    const [encryptionKey, setEncryptionKey] = useState<string | null>(null);\n\n    const setKey = useCallback((key: string) => {\n        setEncryptionKey(key);\n    }, []);\n\n    const decrypt = useCallback(\n        async (item: VaultItem): Promise<string> => {\n            if (!encryptionKey) {\n                throw new Error('Encryption key not set');\n            }\n            return decryptVaultItem(item, encryptionKey);\n        },\n        [encryptionKey]\n    );\n\n    return {\n        decrypt,\n        setEncryptionKey: setKey,\n    };\n};\n\n","/**\n * VaultPage Component\n * \n * Main vault page with PIN/biometric authentication gate\n */\n\nimport { useState, useEffect } from 'react';\nimport { Helmet } from 'react-helmet-async';\nimport { FiLock, FiPlus, FiShield, FiSearch, FiFilter } from 'react-icons/fi';\nimport { Button } from '@/components/ui/Button';\nimport { TextField } from '@/components/ui/TextField';\nimport { LoadingSpinner } from '@/components/LoadingSpinner';\nimport { VaultItemSkeleton } from '@/components/ui/Skeleton';\nimport { VaultAuthGate } from '../components/VaultAuthGate';\nimport { VaultItemCard } from '../components/VaultItemCard';\nimport { VaultItemModal } from '../components/VaultItemModal';\nimport { useVaultItems, useCreateVaultItem, useUpdateVaultItem, useDeleteVaultItem, useDecryptVaultItem } from '../hooks/useVault';\nimport { useAuth } from '@/features/auth/hooks/useAuth';\nimport { isVaultSessionValid, clearVaultSession } from '@/lib/services/vault-storage';\nimport { useNavigate } from 'react-router-dom';\nimport toast from 'react-hot-toast';\nimport type { VaultItem } from '@/types';\n\nconst VaultPage = () => {\n    const { user } = useAuth();\n    const navigate = useNavigate();\n    const [isAuthenticated, setIsAuthenticated] = useState(false);\n    const [encryptionKey, setEncryptionKey] = useState<string | null>(null);\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [editingItem, setEditingItem] = useState<VaultItem | null>(null);\n    const [editingDecryptedContent, setEditingDecryptedContent] = useState<string>('');\n    const [searchQuery, setSearchQuery] = useState('');\n    const [filterType, setFilterType] = useState<VaultItem['type'] | 'all'>('all');\n\n    const { data: vaultItems = [], isLoading } = useVaultItems();\n    const createMutation = useCreateVaultItem();\n    const updateMutation = useUpdateVaultItem();\n    const deleteMutation = useDeleteVaultItem();\n    const { decrypt, setEncryptionKey: setDecryptKey } = useDecryptVaultItem();\n\n    // Check session on mount\n    useEffect(() => {\n        if (isVaultSessionValid()) {\n            setIsAuthenticated(true);\n        }\n    }, []);\n\n    // Set encryption key when authenticated\n    useEffect(() => {\n        if (isAuthenticated && encryptionKey) {\n            createMutation.setEncryptionKey(encryptionKey);\n            updateMutation.setEncryptionKey(encryptionKey);\n            setDecryptKey(encryptionKey);\n        }\n    }, [isAuthenticated, encryptionKey, createMutation, updateMutation, setDecryptKey]);\n\n    // Session timeout check\n    useEffect(() => {\n        const interval = setInterval(() => {\n            if (!isVaultSessionValid() && isAuthenticated) {\n                setIsAuthenticated(false);\n                setEncryptionKey(null);\n                clearVaultSession();\n                toast.error('Vault session expired. Please unlock again.');\n            }\n        }, 60000); // Check every minute\n\n        return () => clearInterval(interval);\n    }, [isAuthenticated]);\n\n    const handleAuthenticated = (pin?: string) => {\n        setEncryptionKey(pin || null);\n        setIsAuthenticated(true);\n    };\n\n    const handleLogout = () => {\n        setIsAuthenticated(false);\n        setEncryptionKey(null);\n        clearVaultSession();\n        toast.success('Vault locked');\n    };\n\n    const handleCreateItem = () => {\n        setEditingItem(null);\n        setEditingDecryptedContent('');\n        setIsModalOpen(true);\n    };\n\n    const handleEditItem = async (item: VaultItem, currentContent: string) => {\n        if (!encryptionKey) {\n            toast.error('Encryption key not available');\n            return;\n        }\n\n        // If content not already decrypted, decrypt it\n        let decryptedContent = currentContent;\n        if (!decryptedContent) {\n            try {\n                decryptedContent = await decrypt(item);\n            } catch (error) {\n                toast.error('Failed to decrypt item');\n                return;\n            }\n        }\n\n        setEditingItem(item);\n        setEditingDecryptedContent(decryptedContent);\n        setIsModalOpen(true);\n    };\n\n    const handleDeleteItem = async (itemId: string) => {\n        if (!confirm('Are you sure you want to delete this vault item? This cannot be undone.')) {\n            return;\n        }\n\n        try {\n            await deleteMutation.mutateAsync(itemId);\n        } catch (error) {\n            // Error handled by hook\n        }\n    };\n\n    const handleSaveItem = async (data: {\n        type: VaultItem['type'];\n        title: string;\n        content: string;\n        metadata?: Partial<VaultItem['metadata']>;\n    }) => {\n        if (!encryptionKey) {\n            toast.error('Encryption key not available');\n            return;\n        }\n\n        try {\n            if (editingItem) {\n                await updateMutation.mutateAsync({\n                    itemId: editingItem.id,\n                    updates: data,\n                });\n            } else {\n                await createMutation.mutateAsync(data);\n            }\n            setIsModalOpen(false);\n            setEditingItem(null);\n            setEditingDecryptedContent('');\n        } catch (error) {\n            // Error handled by hook\n        }\n    };\n\n    // Filter and search items\n    const filteredItems = vaultItems.filter((item) => {\n        const matchesSearch = searchQuery === '' || \n            item.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n            item.metadata.tags?.some(tag => tag.toLowerCase().includes(searchQuery.toLowerCase()));\n        \n        const matchesFilter = filterType === 'all' || item.type === filterType;\n        \n        return matchesSearch && matchesFilter;\n    });\n\n    // Show auth gate if not authenticated\n    if (!isAuthenticated || !encryptionKey) {\n        return (\n            <VaultAuthGate\n                onAuthenticated={handleAuthenticated}\n                onSetupComplete={() => {\n                    // PIN setup complete, already authenticated\n                }}\n            />\n        );\n    }\n\n    return (\n        <>\n            <Helmet>\n                <title>Vault - Family Safety App</title>\n                <meta name=\"description\" content=\"Securely store sensitive information\" />\n            </Helmet>\n\n            <div className=\"space-y-6\">\n                {/* Header */}\n                <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-6 mb-8\">\n                    <div>\n                        <div className=\"flex items-center gap-3 mb-3 flex-wrap\">\n                            <h1 className=\"text-headline-lg md:text-display-sm font-normal text-on-surface\">Digital Vault</h1>\n                            <div className=\"flex items-center gap-1.5 px-3 py-1.5 bg-green-50 border border-green-200 rounded-full\">\n                                <FiShield size={14} className=\"text-green-600\" />\n                                <span className=\"text-label-sm font-semibold text-green-700\">Encrypted</span>\n                            </div>\n                        </div>\n                        <p className=\"text-body-lg text-on-variant\">\n                            Secure storage for passwords and sensitive information\n                        </p>\n                    </div>\n                    <div className=\"flex items-center gap-3\">\n                        <Button\n                            variant=\"outlined\"\n                            onClick={handleLogout}\n                            startIcon={<FiLock size={18} />}\n                            className=\"btn-base border-2 border-outline-variant text-on-surface hover:bg-surface-variant\"\n                        >\n                            Lock Vault\n                        </Button>\n                        <Button\n                            variant=\"filled\"\n                            onClick={handleCreateItem}\n                            startIcon={<FiPlus size={18} />}\n                            className=\"btn-base bg-primary text-on-primary hover:bg-primary/90 shadow-elevation-2\"\n                        >\n                            Add Item\n                        </Button>\n                    </div>\n                </div>\n\n                {/* Search and Filter */}\n                {vaultItems.length > 0 && (\n                    <div className=\"flex flex-col sm:flex-row gap-4\">\n                        <div className=\"flex-1\">\n                            <TextField\n                                value={searchQuery}\n                                onChange={(e) => setSearchQuery(e.target.value)}\n                                placeholder=\"Search vault items...\"\n                                startAdornment={<FiSearch size={18} className=\"text-gray-400\" />}\n                                fullWidth\n                            />\n                        </div>\n                        <div className=\"sm:w-48\">\n                            <select\n                                value={filterType}\n                                onChange={(e) => setFilterType(e.target.value as VaultItem['type'] | 'all')}\n                                className=\"input-base\"\n                            >\n                                <option value=\"all\">All Types</option>\n                                <option value=\"password\">Passwords</option>\n                                <option value=\"note\">Notes</option>\n                                <option value=\"card\">Cards</option>\n                                <option value=\"identity\">Identity</option>\n                                <option value=\"document\">Documents</option>\n                            </select>\n                        </div>\n                    </div>\n                )}\n\n                {/* Vault Items Grid */}\n                {isLoading ? (\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                        {[...Array(6)].map((_, i) => (\n                            <VaultItemSkeleton key={i} />\n                        ))}\n                    </div>\n                ) : filteredItems.length === 0 ? (\n                    <div className=\"card p-12 text-center\">\n                        <div className=\"w-20 h-20 bg-primary-container rounded-full flex items-center justify-center mx-auto mb-6 shadow-elevation-2\">\n                            <FiLock size={32} className=\"text-primary\" />\n                        </div>\n                        <h3 className=\"text-headline-md font-normal text-on-surface mb-3\">\n                            {vaultItems.length === 0 ? 'Your vault is empty' : 'No items found'}\n                        </h3>\n                        <p className=\"text-body-lg text-on-variant mb-8 max-w-md mx-auto\">\n                            {vaultItems.length === 0\n                                ? 'Start by adding your first secure item'\n                                : 'Try adjusting your search or filter'}\n                        </p>\n                        {vaultItems.length === 0 && (\n                            <Button\n                                variant=\"filled\"\n                                onClick={handleCreateItem}\n                                startIcon={<FiPlus size={18} />}\n                                className=\"btn-base bg-primary text-on-primary hover:bg-primary/90 shadow-elevation-2\"\n                            >\n                                Add Your First Item\n                            </Button>\n                        )}\n                    </div>\n                ) : (\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                        {filteredItems.map((item) => (\n                            <VaultItemCard\n                                key={item.id}\n                                item={item}\n                                encryptionKey={encryptionKey!}\n                                onEdit={handleEditItem}\n                                onDelete={handleDeleteItem}\n                            />\n                        ))}\n                    </div>\n                )}\n\n                {/* Vault Item Modal */}\n                {isModalOpen && (\n                    <VaultItemModal\n                        isOpen={isModalOpen}\n                        onClose={() => {\n                            setIsModalOpen(false);\n                            setEditingItem(null);\n                            setEditingDecryptedContent('');\n                        }}\n                        onSave={handleSaveItem}\n                        item={editingItem}\n                        decryptedContent={editingDecryptedContent}\n                        isLoading={createMutation.isPending || updateMutation.isPending}\n                    />\n                )}\n            </div>\n        </>\n    );\n};\n\nexport default VaultPage;\n"],"names":["ALGORITHM","async","deriveKey","password","salt","encoder","TextEncoder","passwordKey","crypto","subtle","importKey","encode","name","buffer","iterations","hash","length","encrypt","data","dataBuffer","encryptionSalt","getRandomValues","Uint8Array","key","iv","encrypted","tagLength","ciphertext","btoa","String","fromCharCode","hashPIN","pin","hashBuffer","digest","Array","from","map","b","toString","padStart","join","VAULT_PIN_KEY","VAULT_SESSION_KEY","getPINHash","localStorage","getItem","createVaultSession","expiresAt","Date","now","setItem","isVaultSessionValid","expires","parseInt","clearVaultSession","removeItem","extendVaultSession","VaultAuthGate","onAuthenticated","onSetupComplete","setPin","useState","confirmPin","setConfirmPin","showPin","setShowPin","isSettingUp","setIsSettingUp","isAuthenticating","setIsAuthenticating","error","setError","pinExists","useEffect","sessionValid","checkSession","handleSetupPIN","test","pinHash","storePINHash","toast","success","setupPin","err","console","handleAuthenticate","enteredPinHash","authPin","jsx","className","children","jsxs","FiLock","size","FiShield","TextField","type","value","onChange","e","target","placeholder","fullWidth","maxLength","inputMode","pattern","startAdornment","endAdornment","onClick","FiEyeOff","FiEye","autoFocus","onKeyDown","Fragment","Button","variant","disabled","loading","window","PublicKeyCredential","icon","startIcon","FiKey","updateVaultItem","userId","itemId","updates","encryptionKey","updateData","updatedAt","serverTimestamp","itemResponse","itemDoc","getDoc","doc","db","exists","item","id","title","metadata","createdAt","toDate","accessedAt","updateDoc","getVaultItem","existingItem","existingMetadata","content","atob","c","charCodeAt","decryptVaultItem","Error","ciphertextBytes","saltBytes","ivBytes","decrypted","decrypt","TextDecoder","decode","typeIcons","note","card","identity","document","VaultItemCard","onEdit","onDelete","decryptedContent","setDecryptedContent","isDecrypting","setIsDecrypting","isRevealed","setIsRevealed","copied","setCopied","handleReveal","favorite","FiStar","FiEdit2","FiTrash2","tags","tag","navigator","clipboard","writeText","setTimeout","FiCheck","FiCopy","toLocaleDateString","vaultTypes","label","VaultItemModal","isOpen","onClose","onSave","isLoading","formData","setFormData","showContent","setShowContent","tagInput","setTagInput","errors","setErrors","handleChange","field","prev","newErrors","handleAddTag","trim","includes","handleSubmit","preventDefault","Object","keys","stopPropagation","FiX","onSubmit","required","rows","FiTag","filter","t","handleRemoveTag","checked","htmlFor","useVaultItems","user","useAuth","useQuery","queryKey","queryFn","response","vaultQuery","query","collection","orderBy","snapshot","getDocs","items","forEach","docSnap","push","getUserVaultItems","enabled","staleTime","useCreateVaultItem","queryClient","useQueryClient","setEncryptionKey","setKey","useCallback","mutation","useMutation","mutationFn","vaultRef","vaultItem","category","setDoc","createdData","createVaultItem","onSuccess","invalidateQueries","onError","message","useDeleteVaultItem","deleteDoc","deleteVaultItem","VaultPage","useNavigate","isAuthenticated","setIsAuthenticated","isModalOpen","setIsModalOpen","editingItem","setEditingItem","editingDecryptedContent","setEditingDecryptedContent","searchQuery","setSearchQuery","filterType","setFilterType","vaultItems","createMutation","updateMutation","useUpdateVaultItem","deleteMutation","setDecryptKey","useDecryptVaultItem","interval","setInterval","clearInterval","handleAuthenticated","handleCreateItem","handleEditItem","currentContent","handleDeleteItem","confirm","mutateAsync","filteredItems","matchesSearch","toLowerCase","some","matchesFilter","Helmet","FiPlus","FiSearch","_","i","VaultItemSkeleton","isPending"],"mappings":"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"}